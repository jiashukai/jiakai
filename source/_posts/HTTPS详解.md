---
title: HTTPS详解.md
date: 2018-12-26T15:46:24.000Z
tags: null
---

# HTTPS协议详解

## HTTP的缺点

1.通信使用明文（不加密），内容可能被窃取 2.不验证通信方的身份，因此有可能遭遇伪装 3.无法证明报文的完整性，所以有可能已经被篡改 这些问题不仅在HTTP上出现，其他未加密的协议也会存在这类问题

### 通信使用明文可能会被窃听

由于HTTP本身不具备加密的功能，所以也无法做到对通信整体进行加密，即，HTTP报文使用明文（未经过加密的报文）方式发送。

### 加密防止被窃听

在目前大家正在研究的如何防止窃听保护信息的几种对策中。加密的对象可以有这么几个：

#### 通信的加密

一种方式就是讲通信加密。HTTP协议中没有加密机制，但可以通过和SSL（安全套接层）或TLS（安全传输协议）的组合使用，加密HTTP的通信内容。 用SSL建立安全通信线路后，就可以在这条线路上进行HTTP通信了。与SSL组合使用的HTTP被称为HTTPS（超文本传输安全协议）

#### 内容的机密
还有一种将参与通信的内容本身加密的方式。由于HTTP协议中没有加密机制，那么就对HTTP协议传输的内容本身加密。即把HTTP报文里所含的内容进行加密处理。在这种情况下，客户端要对HTTP报文进行加密处理后在发送请求。
#### HTTP协议的实现本身非常简单，不论是谁发过来的请求都会返回响应，因此不确认通信方，会存在以下各种隐患
1.无法确定请求发送至目标的Web服务器是否按真实意图返回响应的那台服务器，因此不确认通信方。有可能是已伪装的web服务器。
2.无法确定响应返回到的客户端是否是真实意图接受响应的客户端。有可能是已伪装的客户端。
3.无法确定正在通信的对方是否具备访问权限。因为某些web服务器上保存着重要的信息，只想发给特定用户通信的权限
4.无法判定请求来自何方，出自谁手。
5.即使是无意义的请求也会照单全收。无法阻止海量请求下的Dos攻击
###查明对手的证书
虽然使用HTTP协议无法确定通信方，但是如果使用SSL则可以。SSL不仅提供加密处理，而且还使用了一种被称为证书的手段，可用于确定方。证书由值得信任的第三方机构颁发，用以证明服务器和客户端是实际存在的。另外，伪造证书从技术角度来说是异常困难的一件事。所以只要能够确认通信方持有的证书，即可判断通信方的真实意图。通过使用证书，以证明通信方就是意料中的服务器。
### 接收到的内容可能有误
由于HTTP协议证明通信的报文完整性，因此，在请求或响应发送出去之后直到对方接收之前的这段时间内，即使请求或响应的内容遭到篡改，也没有办法获悉。换句话说，没有任何办法确认，发出的请求 响应和接收到的请求响应四前后相同的。
#### 如何防止被篡改
虽然HTTP有使用确认报文完整性的方法，但事实上并不便捷，可靠。其中常用的是MD5和SHA—1等散列值校验的方法，以及迎来确认文件的数字签名方法。可惜的是，用这些方法也依然无法确保确认结果正确。因为PGP和MD5本身被改写的话，用户是没有办法意识到的。
### HTTP+加密+认证+完整性保护=HTTPS
HTTP加上加密处理和认证以及完整性保护后即是HTTPS。            
经常会在 Web 的登录页面和购物结算界面等使用 HTTPS 通信。使用 HTTPS 通信时，不再用 http://，而是改用 https://。另外，当浏览器访问 HTTPS 通信有效的 Web网站时，浏览器的地址栏内会出现一个带锁的标记。对 HTTPS 的显示方式会因浏览器的不同而有所改变。
### HTTPS是身披SSL外壳的HTTP
HTTPS并非是应用层的一种新协议。只是HTTP通信接口部分用SSL和TLS协议代替而已。通常，HTTP直接和TCP通信。当时用SSL时，则演变成先和SSL通信，再由SSL和TCP通信了。简言之，其实就是身披SSL协议这层外壳的HTTP。           
！[image text](https://github.com/jiashukai/jiakai/blob/master/source/_posts/pictures/HTTPS1.png)          
采用SSL后，HTTP就拥有了HTTPS的加密，证书和完整性保护这些功能。SSL是独立于HTTP的协议，其他运行在应用层的SMTP和Telnet等协议均可配合SSL协议使用。可以说SSL是当今世界上应用最为广泛的网络安全技术。
## 相互交换密钥的公开密钥加密技术
在对SSL进行讲解之前，我们先来了解一下加密方法。SSL采用一种公开密钥加密的加密处理方式。近代的加密方法中加密算法是公开的，而密钥却是保密的。通过这种方式得以保持加密方法的安全性。加密和解密都会用到密钥。没有密钥就无法对密钥进行解密，反过来说，任何人只要持有密钥就能解密了。如果密钥被攻击者获得，那加密也就失去了意义
### 共享密钥加密的困境
加密和解密用同一个密钥的方式称为共享密钥，也被叫做对称密钥加密。
以共享密钥方式加密时必须将密钥也发给对方。可究竟怎么才能安全地转交？在互联网上转发密钥时，如果通信被监听name密钥就可会落入攻击者之手，同时也就失去了加密的意义。另外害的设法安全地保管接收到密钥。
###使用两把密钥的公开密钥加密
公开密钥加密方式很好地解决了共享密钥加密的困难。
公开密钥加密使用一对非对称的密钥。一把叫做私有密钥，另一把叫做公开密钥。私有密钥不能让其他任何人知道，而公开密钥则可以随意发布，任何人都可以获得。公开密钥和私有密钥是配对的一套密钥。        
使用公开密钥加密方式，发送密文的一方使用对方的公开密钥进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。利用这种方式，不需要发送用来解密的私有密钥，也不必担心被攻击者窃听而盗走。
另外，要想根据密文和公开密钥，恢复到信息原文是异常困难的，因为解密过程就是在对离散对数进行求值，这并非轻而易举就能办到的。退一步讲，如果能对一个非常强大的整数做到快速地因式分解，name密码破解还是存在希望的。但就目前的技术来看还不太实现
#HTTPS采用混合加密机制
HTTPS采用共享密钥加密和公开密钥加密两者并用的混合加密机制
（1）使用公开密钥加密方式安全地交换在稍后的共享密钥中要使用的密钥
（2）确保交换的密钥时安全地前提下，使用共享密钥加密方式进行通信
## 为什么不一直使用HTTPS
既然HTTPS那么安全可靠，那为何所有的web网站不一直使用HTTPS？
其中一个原因是，因为与纯文本通信相比，加密通信会消耗更多的CPU及内存资源。如果每次通信都加密，会消耗相当多的资源，平摊到一台计算机上时，能够处理的请求数量必定也会随之减少。
因此如果是非敏感信息则使用HTTP通信，只有在包含个人信息等敏感数据时，才利用HTTPS加密通信。
特别是每当那些访问量较多的web网站在进行加密处理时，它们索承担多的负载不容小觑。在进行加密处理时，并非对所有内容都进行加密处理，而是仅在那些需要信息隐藏时才会加密，节约资源。
